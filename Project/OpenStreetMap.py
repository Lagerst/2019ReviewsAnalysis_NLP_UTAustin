import folium
import webbrowser
import json
import os
import pandas as pd

m = folium.Map(
    location=[36.05, 104.59],
    zoom_start=7,
    tiles='Stamen Terrain'  # 更改了展开图样式
)

Location = {}
Location['China'] = [36.05, 104.59]
Location['United States'] = [40.858, -96.772]
Location['Russia'] = [65.55, 97.18]
Location['Ireland'] = [52.946, -7.983]
Location['Australia'] = [-23.53, 134.59]
Location['United Kingdom'] = [56.596, -4.175]
Location['New Zealand'] = [-41.1, 172.4]
Location['Belgium'] = [50.633, 4.647]
Location['France'] = [48.0, 4.0]
Location['Italy'] = [42.943, 11.953]
Location['Canada'] = [63.4, -110.4]
Location['Netherlands'] = [52.51, 5.51]
Location['Germany'] = [51.147, 10.386]
Location['Israel'] = [31.524, 34.871]
Location['Switzerland'] = [46.816, 8.236]
Location['Kuwait'] = [29.224, 47.719]
Location['Singapore'] = [1.3114, 103.8222]
Location['Greece'] = [38.393, 24.17]
Location['Romania'] = [45.875, 24.939]
Location['Hong Kong'] = [22.3336, 114.1919]
Location['Romania'] = [45.875, 24.939]
Location['Saudi Arabia'] = [24.886, 44.209]
Location['Sweden'] = [62.67, 16.61]
Location['Turkey'] = [39.3, 34.014]
Location['Spain'] = [39.977, -3.12]
Location['South Africa'] = [-30.52, 24.87]
Location['United Arab Emirates'] = [23.826, 54.404]
Location['India'] = [22.59, 80.6]

Location['AK'] = [64.4459613, -149.680909]
Location['AL'] = [33.2588817, -86.8295337]
Location['AR'] = [35.2048883, -92.4479108]
Location['AZ'] = [34.255, -111.42]
Location['CA'] = [36.7014631, -118.7559974]
Location['CO'] = [38.7251776, -105.6077167]
Location['CT'] = [41.6500201, -72.7342163]
Location['DE'] = [38.6920451, -75.4013315]
Location['FL'] = [27.7567667, -81.4639835]
Location['GA'] = [32.3293809, -83.1137366]
Location['HI'] = [21.2160437, -157.975203]
Location['IA'] = [41.9216734, -93.3122705]
Location['ID'] = [43.509, -115.049]
Location['IN'] = [40.3270127, -86.1746933]
Location['KS'] = [38.27312, -98.5821872]
Location['KY'] = [37.5726028, -85.1551411]
Location['MA'] = [42.329, -72.01]
Location['MD'] = [39.188, -76.625]
Location['ME'] = [45.709097, -68.8590201]
Location['MI'] = [43.6211955, -84.6824346]
Location['MN'] = [45.9896587, -94.6113288]
Location['MS'] = [32.9715645, -89.7348497]
Location['MO'] = [38.7604815, -92.5617875]
Location['MT'] = [47.3752671, -109.6387579]
Location['NE'] = [41.7370229, -99.5873816]
Location['ND'] = [47.6201461, -100.540737]
Location['NH'] = [43.4849133, -71.6553992]
Location['NJ'] = [40.0757384, -74.4041622]
Location['NM'] = [34.5708167, -105.993007]
Location['NV'] = [39.5158825, -116.8537227]
Location['NY'] = [43.1561681, -75.8449946]
Location['OH'] = [40.2253569, -82.6881395]
Location['OK'] = [34.9550817, -97.2684063]
Location['OR'] = [43.9792797, -120.737257]
Location['PA'] = [40.9699889, -77.7278831]
Location['RI'] = [41.7962409, -71.5992372]
Location['SC'] = [33.702, -80.662]
Location['SD'] = [44.6471761, -100.348761]
Location['TN'] = [35.7730076, -86.2820081]
Location['TX'] = [31.8160381, -99.5120986]
Location['UT'] = [39.4225192, -111.7143584]
Location['VA'] = [37.1232245, -78.4927721]
Location['VT'] = [44.5990718, -72.5002608]
Location['WA'] = [47.2868352, -120.2126139]
Location['WI'] = [44.4308975, -89.6884637]
Location['WV'] = [38.4758406, -80.8408415]
Location['WY'] = [43.1700264, -107.5685348]
Location['NC'] = [35.6729639, -79.0392919]
Location['IL'] = [40.177, -89.396]
Location['LA'] = [30.475, -92.505]

keys = Location.keys()
print(keys)

data = {}
data['China'] = [['Location'], ['Clean Room'], ['Breakfast']]
data['United States'] = [['Location'], ['Room Size'], ['Staff Services']]
data['Russia'] = [['Breakfast'], ['Location'], ['Room Size']]
data['Ireland'] = [['Location'], ['Staff Services'], ['Breakfast']]
data['Australia'] = [['Location'], ['Staff Services'], ['Comfortable Room']]
data['United Kingdom'] = [['Location'], ['Shower'], ['Staff Services']]
data['New Zealand'] = [['Location'], ['Staff Services'], ['Lovely Room']]
data['Belgium'] = [['Comfortable Room'], ['Location'], ['Staff Services']]
data['France'] = [['Comfortable Room'], ['Location'], ['Breakfast']]
data['Italy'] = [['Comfortable Room'], ['Breakfast'], ['Staff Services']]
data['Canada'] = [['Comfortable Room'], ['Location'], ['Staff Services']]
data['Netherlands'] = [['Staff Services'], ['Location'], ['Comfortable Room']]
data['Germany'] = [['Breakfast'], ['Comfortable Room'], ['Location']]
data['India'] = [['Comfortable room'], ['location'], ['staff Services']]
data['United Arab Emirates'] = [['Comfortable room'], ['location'], ['food']]
data['South Africa'] = [['Comfortable room'], ['location'], ['staff Services']]
data['Spain'] = [['Comfortable room'], ['service'], ['location']]
data['Turkey'] = [['location'], ['Comfortable room'], ['staff Services']]
data['Sweden'] = [['breakfast'], ['Comfortable room'], ['location']]
data['Saudi Arabia'] = [['room size'], ['location'], ['staff Services']]
data['Hong Kong'] = [['location'], ['staff Services'], ['Comfortable room']]
data['Romania'] = [['location'], ['breakfast'], ['Comfortable room']]
data['Greece'] = [['location'], ['Comfortable room'], ['breakfast']]
data['Singapore'] = [['location'], ['Comfortable room'], ['staff Services']]
data['Kuwait'] = [['Comfortable room'], ['staff Services'], ['location']]
data['Switzerland'] = [['Comfortable room'], ['location'], ['bathroom']]
data['Israel'] = [['breakfast'], ['location'], ['Comfortable room']]

data['OH'] = [['Room Size'], ['Staff Service'], ['Breakfast']]
data['OK'] = [['Free Breakfast'], ['Clean Room'], ['Staff Service']]
data['OR'] = [['Clean Bed'], ['Nice Gardens'], ['Breakfast']]
data['PA'] = [['Breakfast'], ['Location'], ['Comfortable Rooms']]
data['RI'] = [['Location'], ['Toilet ?'], ['Breakfast']]
data['SC'] = [['Location'], ['smelly'], ['Comfortable Room']]
data['SD'] = [['Price'], ['Comfortable Room'], ['Furniture']]
data['TN'] = [['Comfortable Room'], ['Coffee'], ['Breakfast']]
data['TX'] = [['Comfortable Room'], ['furnishings'], ['Wifi']]
data['UT'] = [['Staff Service'], ['Breakfast'], ['Location']]
data['VA'] = [['Elevator'], ['Location'], ['Breakfast']]
data['VT'] = [['Restaurants'], ['Comfortable Room'], ['Staff Service']]
data['WA'] = [['Comfortable Room'], ['Staff Service'], ['Location']]
data['WI'] = [['Comfortable Room'], ['Quiet'], ['friendly']]
data['WV'] = [['Staff Service'], ['furniture'], ['Breakfast']]
data['AK'] = [['staff Services'], ['service'], ['Comfortable room']]
data['AL'] = [['staff Services'], ['breakfast'], ['location']]
data['AR'] = [['breakfast'], ['Comfortable room'], ['staff Services']]
data['AZ'] = [['Comfortable room'], ['location'], ['breakfast']]
data['CA'] = [['Comfortable room'], ['service'], ['breakfast']]
data['CO'] = [['Comfortable room'], ['breakfast'], ['service']]
data['CT'] = [['staff Services'], ['price'], ['Comfortable room']]
data['DE'] = [['Comfortable room'], ['staff Services'], ['breakfast']]
data['FL'] = [['Comfortable room'], ['breakfast'], ['service']]
data['GA'] = [['breakfast'], ['Comfortable room'], ['staff Services']]
data['HI'] = [['breakfast'], ['noise'], ['Comfortable room']]
data['IA'] = [['Comfortable room'], ['breakfast'], ['location']]
data['ID'] = [['facilities'], ['breakfast'], ['Comfortable room']]
data['IL'] = [['location'], ['Comfortable room'], ['breakfast']]
data['IN'] = [['breakfast'], ['Comfortable room'], ['service']]
data['KS'] = [['Comfortable room'], ['breakfast'], ['staff Services']]
data['KY'] = [['location'], ['Comfortable room'], ['breakfast']]
data['LA'] = [['breakfast'], ['Comfortable room'], ['staff Services']]
data['MA'] = [['Comfortable room'], ['facilities'], ['breakfast']]
data['MD'] = [['staff Services'], ['Comfortable room'], ['price']]
data['ME'] = [['pool'], ['consistent'], ['staff Service']]
data['MI'] = [['stmosphere'], ['price'], ['clean']]
data['MN'] = [['Comfortable room'], ['staff Service'], ['comfortable']]
data['MS'] = [['feel free'], ['breakfast'], ['Comfortable room']]
data['MO'] = [['staff Service'], ['Comfortable room'], ['quiet']]
data['MT'] = [['service'], ['staff Service'], ['atmosphere']]
data['NE'] = [['furnishings'], ['service'], ['Comfortable room']]
data['ND'] = [['location'], ['pickup service'], ['hotel computer']]
data['NH'] = [['breakfast'], ['Comfortable room'], ['view']]
data['NJ'] = [['clean'], ['breakfast'], ['staff Service']]
data['NM'] = [['breakfast'], ['furnishings'], ['access']]
data['NV'] = [['breakfast'], ['staff Service'], ['furnishings']]
data['NY'] = [['breakfast'], ['Comfortable room'], ['sleep']]
data['OH'] = [['Room Size'], ['availability'], ['Location']]
data['OK'] = [['Comfortable room'], ['long check'], ['staff Service']]
data['OR'] = [['expedia'], ['gardens'], ['pool']]
data['PA'] = [['breakfast'], ['location'], ['view']]

# Marker
for item in Location:
    if item in data.keys():
        df = pd.DataFrame(data=data[item], columns=['keywords'])
    else:
        df = pd.DataFrame(data=[['1'], ['2']], columns=['keywords'])
    html = df.to_html()
    os.chdir(r"D:\地图")
    folium.Marker(
        location=Location[item],
        popup=folium.Popup(html, max_width=450)).add_to(m)

file_path = r"D:\地图\marker_chart.html"
m.save(file_path)

webbrowser.open(file_path)
